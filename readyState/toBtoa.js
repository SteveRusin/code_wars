const fs = require("fs");
const { join } = require("path");

// https://murych.com/asforjs/tthmjs/01/#bGV0IGNvdW50ID0gMDsKT2JqZWN0LmRlZmluZVByb3BlcnR5KGRvY3VtZW50LCAncmVhZHlTdGF0ZScsIHsKICBnZXQ6ICgpID0+IHsKICAgIGlmIChjb3VudCsrID09PSAwKSB7CiAgICAgIHJldHVybiAnbG9hZGluZyc7CiAgICB9CgogICAgcmV0dXJuICdjb21wbGV0ZSc7CiAgfQp9KTsKCg==
// const target = './readyState1.js'
// https://murych.com/asforjs/tthmjs/01/#Y29uc3Qgb3JpZ2luYWwgPSB3aW5kb3cuc2V0SW50ZXJ2YWw7Cgp3aW5kb3cuc2V0SW50ZXJ2YWwgPSBmdW5jdGlvbiAoZm4sIHRpbWUpIHsKICBmdW5jdGlvbiB3cmFwcGVyKC4uLmFyZ3MpIHsKICAgIGNvbnN0IHJlcyA9IGZuLmFwcGx5KHRoaXMsIGFyZ3MpOwoKICAgIGlmICghcmVzKSB7CiAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpOwogICAgICBzZXRZb3VEaWRJdCgpOwogICAgfQoKICAgIHJldHVybiByZXM7CiAgfQogIGNvbnN0IGludGVydmFsID0gb3JpZ2luYWwod3JhcHBlciwgdGltZSk7CiAgcmV0dXJuIGludGVydmFsOwp9OwoKY29uc3Qgc2V0WW91RGlkSXQgPSAoKSA9PiB7CiAgY29uc3Qgc3BhbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5jb3VudERvd25fX3RleHQiKTsKICBzcGFuLmlubmVySFRNTCA9ICJZb3UgZGlkIGl0IjsKICBzcGFuLmNsYXNzTGlzdC5hZGQoImNvdW50RG93bl9fdGV4dF9vayIpOwp9Owo=
// const target = "./readyState2.js";
// https://murych.com/asforjs/tthmjs/01/#Y29uc3Qgb3JpZ2luYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJzcGFuIik7Cgp3aW5kb3cuY3VzdG9tRWxlbWVudHMuZGVmaW5lKAogICJteS1zcGFuIiwKICBjbGFzcyBleHRlbmRzIEhUTUxFbGVtZW50IHsKICAgIHNldCBpbm5lclRleHQgKHRleHQpIHsKICAgICAgdGhpcy5pbm5lckhUTUwgPSB0ZXh0ID09PSAnRmFpbCcgPyAnWW91IGRpZCBpdCcgOiB0ZXh0OwogICAgfQogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHN1cGVyKCk7CiAgICB9CiAgfSwKKTsKCmNvbnN0IG9yaWdpbmFsQWRkID0gRE9NVG9rZW5MaXN0LnByb3RvdHlwZS5hZGQ7CkRPTVRva2VuTGlzdC5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKGNsYXNzTmFtZSkgewogIGlmIChjbGFzc05hbWUgPT09ICdjb3VudERvd25fX3RleHRfYm9vbScpIHsKICAgIHJldHVybiBvcmlnaW5hbEFkZC5jYWxsKHRoaXMsICdjb3VudERvd25fX3RleHRfb2snKTsKICB9CiAgcmV0dXJuIG9yaWdpbmFsQWRkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmNvbnN0IG5ld1NwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJteS1zcGFuIik7Cm5ld1NwYW4uY2xhc3NMaXN0ID0gb3JpZ2luYWwuY2xhc3NMaXN0OwoKb3JpZ2luYWwucmVwbGFjZVdpdGgobmV3U3Bhbik7Cg==
// const target = './readyState3.js'
// https://murych.com/asforjs/tthmjs/01/#Ly8gaWRlYWxseSB0cnkgdG8gZmluZCBpdApjb25zdCBzdHlsZXMgPSBkb2N1bWVudC5zdHlsZVNoZWV0c1swXTsKCgpjb25zdCBvayA9IHN0eWxlcy5jc3NSdWxlc1s1XTsKY29uc3QgZmFpbCA9IHN0eWxlcy5jc3NSdWxlc1s0XTsKCgpzdHlsZXMuaW5zZXJ0UnVsZShgLmNvdW50RG93bl9fdGV4dF9ib29tIHsgCiAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogIGNvbG9yOiBncmVlbjsKfWAsIHN0eWxlcy5jc3NSdWxlcy5sZW5ndGgpOwoKc3R5bGVzLmluc2VydFJ1bGUoYC5jb3VudERvd25fX3RleHRfYm9vbTo6YmVmb3JlIHsKICBkaXNwbGF5OiBibG9jazsKICBjb250ZW50OiAiWW91IGRpZCBpdCI7Cn1gLCBzdHlsZXMuY3NzUnVsZXMubGVuZ3RoKTsK
// const target = './readyState4.js'
// https://murych.com/asforjs/tthmjs/01/#ZG9jdW1lbnQud3JpdGUoIjwhLS0iKTsKCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLCAoKSA9PiB7CiAgY29uc3QgY29tbWVudE5vZGUgPSBBcnJheS5wcm90b3R5cGUuZmluZC5jYWxsKAogICAgZG9jdW1lbnQuYm9keS5jaGlsZE5vZGVzLAogICAgKG5vZGUpID0+IG5vZGUubm9kZVR5cGUgPT09IGRvY3VtZW50LkNPTU1FTlRfTk9ERSwKICApOwogIGNvbnN0IHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpOwogIHNjcmlwdC50ZXh0Q29udGVudCA9IGNvbW1lbnROb2RlLmRhdGEKICAgIC5tYXRjaCgvPHNjcmlwdD4oW148XSopPFwvc2NyaXB0Pi8pWzFdCiAgICAucmVwbGFjZSgiKCBkb2N1bWVudC5yZWFkeVN0YXRlICkiLCAiKCdsb2FkaW5nJykiKTsKICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHNjcmlwdCk7CiAgY29tbWVudE5vZGUucmVtb3ZlKCk7Cn0pOwo=
const target = './readyState5.js'

const file = fs.readFileSync(join(__dirname, target), "utf8");

const hashed = btoa(file);

const fullUrl = `https://murych.com/asforjs/tthmjs/01/#${hashed}`;

console.log(fullUrl);

pbCopy(fullUrl);

function pbCopy(data) {
  const proc = require("child_process").spawn("pbcopy");
  proc.stdin.write(data);
  proc.stdin.end();
}
